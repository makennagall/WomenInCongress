
# This is a Shiny web application. You can run the application by clicking
# the 'Run App' button above.

library(shiny)
library(plotly)
library(forcats)
library(dplyr)
Frequency <- read.csv('https://raw.githubusercontent.com/makennagall/WomenInCongress/main/frequency.csv')
WomenPerSession <- read.csv('https://raw.githubusercontent.com/makennagall/WomenInCongress/main/WomenPerSession.csv')
AllOutput <- read.csv('https://raw.githubusercontent.com/makennagall/WomenInCongress/main/compiledNewOutputs.csv')
TermsCount <- read.csv('https://raw.githubusercontent.com/makennagall/WomenInCongress/main/termsCountNew.csv')
colnames(Frequency)
colnames(AllOutput)
typeof(Frequency)
termList = as.list(Frequency)
termList$Term
AllOutput <- mutate(AllOutput, date = paste(LatestActionMonth,"/",LatestActionDay,"/",LatestActionYear, sep = ""))
AllOutput$date <- as.Date(AllOutput$date, format = "%m/%d/%Y")
#add a DayMonth variable that is only the day and month so they can be displayed on the y axis:
AllOutput <- mutate(AllOutput, DayMonth = format(as.Date(date), "%m-%d"))
# Define UI for application that draws a histogram
ui <- fluidPage(
  
  # Application title
  titlePanel("Women in Congress"),
  
  # Sidebar with a slider input for number of bins 
  sidebarLayout(
    position = "left",
    sidebarPanel(
      checkboxGroupInput("termSelected", h3("Term List"),
                   choices = termList$Term, selected = termList$Term),

      sliderInput("Congress",
                  "Congressional Sessions:",
                  min = 82,
                  max = 117,
                  value = c(82,117))),
    
    # Show a plot of the generated distribution
    mainPanel(
      h1("Women in Congress Graph", align = 'center'),
      plotlyOutput("womenPlot")
    )
  )
)

# Define server logic required to draw a histogram
server <- function(input, output) {
  output$plotly_click <- renderText(as.character(event_data("plotly_click")))
  
  output$womenPlot <- renderPlotly({
    #draw plotly graph:
    fig <- plot_ly(
      data = AllOutput, 
      type = "scatter", 
      mode = "markers",
      x = ~LatestActionYear, 
      y = ~DayMonth, 
      color = ~SponsorParty, 
      legendgrouptitle = "Party",
      hoverinfo = 'text',
      text = ~paste("Title:", Title, "<br>", "URL:", URL))
      })
  output$test <- renderText("hiiiiiii")
}

# Run the application 
shinyApp(ui = ui, server = server)
